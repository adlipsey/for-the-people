<!DOCTYPE html>
<html>
<head>
	<title>For the People - Polling Places</title>
	<!--jQuery Core CDN-->
	<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<!--Leaflet CSS CDN-->
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
   integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
   crossorigin=""/>
   <!--Leaflet js CDN-->
   <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js" integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log==" crossorigin=""></script>
   <link rel="stylesheet" href="./styles.css">

	<style> .col-lg-12 { padding: 10px; margin: 5px;} .places {padding: 10px; margin: 10px; border: 2px solid #993300; background-color: white;} p{padding:10px; margin: 10px;} p:hover { color: red;} p.map {padding: 50px; border: 2px solid blue;} #voterMap {height: 40vw; width: 40vw; margin:0 auto;} body {background-color: #003366;} h3 {color: white;}</style>
</head>
<body>
	<nav class="navbar">
        <a class="navbar-brand" href="#"><h4>For The People</h4></a>
        <ul class="nav nav-bar justify-content-end">
            <li class="nav-item">
                <p class="nav-link">Welcome, user</p>
            </li>
            <form>
                <button class="btn btn-outline-light my-2 my-sm-0" type="submit">Logout</button>
            </form>
        </ul>
    </nav>
	<div class="container">
		<div class="row">
			<div class="col-lg-12">
				<div  class="text-center" id="voterMap">
				</div>
			</div><!--End col-->
		</div><!--End of row-->
		<div class="row">
			<div class="col-lg-12" id="list">
				<h3>Designated Polling Place</h3>
				<div class="places">
					<div class="row">
						<div class="col-lg-3">
							<p class="loc-name">Name of place</p>
						</div>
						<div class="col-lg-6">
							<p class="loc-add">Address</p>
						</div>
						<div class="col-lg-3">
							<p class="loc-hours">Hours</p>
						</div>
					</div>
				</div><!--End of place entry-->
			</div><!--End col #list-->
		</div><!--End of row-->
	</div><!--End of container-->
	<script type="text/javascript">
	$(document).ready(function(){
		var mymap;
		//http request to get user address from DB
		$.get("/api/map").done(function(res){
			//Center map on user's geocoded address
			mymap = L.map("voterMap").setView(res.geocode, 15);
			//OpenStreetMap tile layer so it looks pretty
			L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    			attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
			}).addTo(mymap);
			//Place marker at user's address
			var user = L.marker(res.geocode).addTo(mymap);
			//Pop-up to clarify it is the user's house
			user.bindPopup(res.address + "<br>Your Home");
		}).done( function(){
			//
			$.get("/api/polls").done(function(resp){
				var poll = L.marker(resp.address.geo).addTo(mymap);
				poll.bindPopup(resp.address.locationName);
				$(".loc-name").html(resp.address.locationName);
				$(".loc-add").html(resp.address.line1 + " " + resp.address.city+", "+resp.address.state+ " " + resp.address.zip);
				$(".loc-hours").html("Open: " + resp.pollingHours);
			});
		});
	});

	</script>
</body>
</html>
